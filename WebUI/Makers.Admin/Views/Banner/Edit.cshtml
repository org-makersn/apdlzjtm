@model BannerExT
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
    
    int bannerType = ViewBag.BannerType;

    string banner0 = string.Empty;
    string banner1 = string.Empty;
    string banner2 = string.Empty;
    string banner3 = string.Empty;
    string banner4 = string.Empty;

    switch (bannerType)
    {
        case 0:
            banner0 = "on";
            break;
        case 1:
            banner1 = "on";
            break;
        case 2:
            banner2 = "on";
            break;
        case 3:
            banner3 = "on";
            break;
        case 4:
            banner4 = "on";
            break;
        default:
            banner0 = "on";
            break;
    }
}

<div class="contents_zone">
    <h2 class="contents_title">배너 관리</h2>

    <div class="bannerCate">
        <a href="/banner" class="@banner0">전체</a>l
        <a href="/banner?type=1" class="@banner1">디자인</a>l
        <a href="/banner?type=2" class="@banner2">프린팅</a>|
        <a href="/banner?type=3" class="@banner3">스토어</a>|
        <a href="/banner?type=4" class="@banner4">메이커버스</a>|
    </div>

    <form id="insert_form" name="insert_form" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <input type="hidden" id="bannerNo" name="bannerNo" value="@Model.No">
        <table class="tbl_style1" summary="게시판 테이블">
            <colgroup>
                <col width="200x" />
                <col width="auto" />
            </colgroup>
            <caption>게시판</caption>
            <tbody>
            <tbody>
                <tr>
                    <th>관리용 제목</th>
                    <td>
                        <input type="text" id="title" name="title" class="input_text" style="width: 75%;" value="@Model.Title"/></td>
                </tr>
                <tr>
                    <th>이미지</th>
                    <td>
                        @Html.TextBoxFor(model => model.Image, new { type = "file", @class = "input_text", style = "width: 75%;" })
                        @Html.ValidationMessageFor(model => model.Image)
                        @if (!String.IsNullOrEmpty(Model.Image))
                        {
                            <p>
                                <img src="@Url.BannerThumbnail(Model.Image)" width="100" height="36">
                                <input type="checkbox" id="up_image_del" name="up_image_del" value="y" /><label for="up_image_del">파일삭제</label>
                            </p>
                        }
                    </td>
                </tr>
                <tr>
                    <th>링크주소</th>
                    <td>
                        <input type="text" id="Link" name="Link" class="input_text" style="width: 300px;" value="@Model.Link"/>
                        <input type="radio" name="opener" value="y" />
                        새창 &nbsp; 
					<input type="radio" name="opener" value="n" />
                        기존창&nbsp; 
					<p style="color: blue">* http:// 필수 입력</p>
                    </td>
                </tr>
                <tr>
                    <th>노출여부</th>
                    <td>
                        @Html.RadioButtonFor(model => model.PublishYn, "y", new { @id = "yes" })
                        @Html.Label("yes","사용")
                        @Html.RadioButtonFor(model => model.PublishYn, "n", new { @id = "no" })
                        @Html.Label("no","미사용")
                    </td>
                </tr>
                <tr>
                    <th scope="row">
                        <label for="priority">우선순위</label></th>
                    <td>
                        <select id="priority" name="priority" class="input_text" style="width: 120px;">
                            <option value="0">없음</option>
                            @for (var i = 25; i > 0; i--)
                            {
                                if (i == @Model.Priority)
                                {
                                <option value="@i" selected="selected">@i</option>
                                }
                                else
                                {
                                <option value="@i">@i</option>
                                }
                            }
                        </select>

                    </td>
                </tr>
            </tbody>
        </table>
        <input type="hidden" name="bannerType" value="@ViewBag.BannerType" />
    </form>

    <!-- btn -->
    <div class="btn_center">
        <span class="btnWrap medium"><a href="javascript:void(0);" id="Update" class="_btn_reg">수정</a></span>
        <span class="btnWrap medium"><a href="javascript:void(0);" id="GoList" class="_btn_list" onclick="$(location).attr('href','/Banner?type=@Model.Type');">목록</a></span>
        <span class="btnWrap medium"><a href="javascript:void(0);" id="Delete" class="_btn_delete">삭제</a></span>

    </div>

    <!-- // btn -->
    <br />
</div>


@section Scripts{
    <script type="text/javascript">
        function Edit() { }

        Edit.Init = function () {

        }
        $("#Update").click(function () {
            var action_url = '/Banner/BannerUpdate';

            if ($("#Title").val() == '') {
                alert("제목을 입력해 주세요.");
                $("#Title").focus();
                return false;
            }

            if ($("input:checkbox[id='up_image_del']").is(":checked")) {

                if ($("#Image").val() == '') {
                    alert("배너 이미지를 선택해 주세요.");
                    $("#Image").focus();
                    return false;
                }
            }

            if ($("#Link").val() == '') {
                alert("배너 링크주소를 입력해 주세요.");
                $("#Image").focus();
                return false;
            }

            $("#insert_form").attr('action', action_url);
            $("#insert_form").submit();
            //var no = $("#banner_no").val();
            //var title = $("#title").val();
            //var img = ""; // 이미지 제외하고 함
            //var link = $("#url").val();
            //var opener = $(":input:radio[name='opener']:checked").val()
            //var publish = $(":input:radio[name='publish']:checked").val()
            //var priority = $("#priority").val();
            //var image = $("#img").val();

            //var data = {
            //    bannerNo: no,
            //    title: title,
            //    publish: publish,
            //    opener: opener,
            //    link: link,
            //    priority: priority,
            //    image: image
            //}
            //var onSuccess = function (result) {
            //    console.log(result);
            //    location.replace("/Banner");
            //}
            //Ajax.AjaxResponseModelService(this, "/Banner/BannerUpdate", data, onSuccess);

        });

        $("#Delete").click(function () {
            if(!confirm("배너 삭제 하시겠습니까?")) return false;
            var no = $("#bannerNo").val();
            var data = {
                bannerNo: no
            }
            console.log(data);
            var onSuccess = function (result) {
                location.replace("/Banner");
            }
            Ajax.AjaxResponseModelService(this, "/Banner/BannerDelete", data, onSuccess);
        })

        $(document).ready(function () {
            $('input:radio[name="opener"]').filter('[value="@Model.OpenerYn"]').attr('checked', true);
            $('input:radio[name="publish"]').filter('[value="@Model.PublishYn"]').attr('checked', true);

            Edit.Init();
        });
    </script>
}